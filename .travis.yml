language: php
php:
  - 5.4
  - 5.5
  - 5.6
addons:
  firefox: "33.0"
before_script:
 - git clone -q https://github.com/phalcon/cphalcon.git
 - (cd cphalcon/ext; phpize && ./configure && make -B && sudo make install && phpenv config-add ../unit-tests/ci/phalcon.ini &> /dev/null && cd ../..;)
 - (sudo mkdir app/cache && sudo chmod -R a+w app/cache)
 - wget http://getcomposer.org/composer.phar
 - php composer.phar install
 - "sh -e /etc/init.d/xvfb start"
 - "export DISPLAY=:99.0"
 - "wget http://selenium-release.storage.googleapis.com/2.45/selenium-server-standalone-2.45.0.jar"
 - "java -jar selenium-server-standalone-2.45.0.jar > /dev/null &"
 - sleep 5
 - (cd public; sudo php -S localhost:8000 .htrouter.php &)
 - sleep 5
after_script:
 - sudo cat /var/log/apache2/access.log
 - sudo cat /var/log/apache2/error.log
script: (cd ../tests; phpunit --configuration PHPunit.xml --debug)
